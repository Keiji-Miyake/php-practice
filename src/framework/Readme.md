# フレームワーク開発

## 要件

- MVCモデルによるや鎖分離
- データベースの接続管理
- ログイン状態の管理
- URLと物理的なディレクトリ構造と切り離すルーティング機能
- CSRF 対策

## MVCモデル

　ソフトウェアのアーキテクチャにMVCモデルというのが存在します。アプリケーションを、モデル(Model)、ビュー(View)、コントローラ(Controller)という３つの大きな役割に分けて実装を行うアーキテクチャです。多くのフレームワークはこのMVCモデルに則った作りになっています。

### モデル

　アプリケーションのビジネスロジックを担う。Webアプリケーションでは主に、データベースへアクセスしてデータの取得や変更を行う機能をモデルに記述します。

### ビュー

　出力を担う。Web アプリケーションでは主にHTMLを出力しますので、ビューはHTMLの組み立てや情報の出力を行います。

### コントローラ

　ユーザのリクエストを制御し、モデルから情報を取得してビューに橋渡しするのがコントローラです。

## フレームワーク構造

- Request
　ユーザのリクエストを表す。ユーザがリクエストした際のGETやPOSTパラメータ、URLなどの情報を管理します。
- Router
　ユーザがアクセスしてきたURLをRequestクラスから受け取り、どのコントローラを呼び出すかを決定します。これにより物理的なディレクトリ構造に縛られないURLの制御を可能にします。
- Response
　リクエストに対するレスポンス。最終的にユーザへ返すレスポンスの情報を管理します。
- DBManager
　データベースへの接続情報や次に説明するDBRepositoryを管理するクラス。
- DBRepository
　実際にデータベースへのアクセスを伴う処理を管理するクラスです。実際にはデータベース上のテーブルごとにDBRepositoryクラスの子クラスを作成します。
- Controller
　モデルやビューの制御を行う。
- View
　表示を制御する。HTMLが記述されたファイルの読み込みや変数の受け渡しを行います。
- Session
- Application
　アプリケーション全体を表す。RequestクラスやSessionクラスの初期化、コントローラの実行などアプリケーション全体の流れを管理します。
　アプリケーションごとにこのクラスを継承したクラスを定義し、アプリケーション固有の設定（データベース接続情報、ＵＲＬとコントローラの対応など）の定義を行います。データベースの接続情報はDbManageクラスに、URLとコントローラの対応はRouterクラスにそれぞれ設定します。
- ClassLoader

